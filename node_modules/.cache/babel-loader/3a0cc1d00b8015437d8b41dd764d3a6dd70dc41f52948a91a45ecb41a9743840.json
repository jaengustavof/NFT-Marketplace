{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/home/gustavo/blockchain/Marketplace/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar utils_1 = require(\"./utils\");\nfunction fromSplit(split) {\n  var _split = _slicedToArray(split, 5),\n    protectedHeader = _split[0],\n    encrypted_key = _split[1],\n    iv = _split[2],\n    ciphertext = _split[3],\n    tag = _split[4];\n  var jwe = {\n    ciphertext: ciphertext,\n    iv: iv,\n    protected: protectedHeader,\n    tag: tag\n  };\n  if (encrypted_key) jwe.recipients = [{\n    encrypted_key: encrypted_key\n  }];\n  return jwe;\n}\nfunction encodeRecipient(recipient) {\n  var encRec = {};\n  if (recipient.encrypted_key) encRec.encrypted_key = utils_1.fromBase64url(recipient.encrypted_key);\n  if (recipient.header) encRec.header = recipient.header;\n  return encRec;\n}\nfunction encode(jwe) {\n  var encJwe = {\n    ciphertext: utils_1.fromBase64url(jwe.ciphertext),\n    protected: utils_1.fromBase64url(jwe.protected),\n    iv: utils_1.fromBase64url(jwe.iv),\n    tag: utils_1.fromBase64url(jwe.tag)\n  };\n  if (jwe.aad) encJwe.aad = utils_1.fromBase64url(jwe.aad);\n  if (jwe.recipients) encJwe.recipients = jwe.recipients.map(encodeRecipient);\n  if (jwe.unprotected) encJwe.unprotected = jwe.unprotected;\n  return encJwe;\n}\nfunction decodeRecipient(encoded) {\n  var recipient = {};\n  if (encoded.encrypted_key) recipient.encrypted_key = utils_1.toBase64url(encoded.encrypted_key);\n  if (encoded.header) recipient.header = encoded.header;\n  return recipient;\n}\nfunction decode(encoded) {\n  var jwe = {\n    ciphertext: utils_1.toBase64url(encoded.ciphertext),\n    protected: utils_1.toBase64url(encoded.protected),\n    iv: utils_1.toBase64url(encoded.iv),\n    tag: utils_1.toBase64url(encoded.tag)\n  };\n  if (encoded.aad) jwe.aad = utils_1.toBase64url(encoded.aad);\n  if (encoded.recipients) jwe.recipients = encoded.recipients.map(decodeRecipient);\n  if (encoded.unprotected) jwe.unprotected = encoded.unprotected;\n  return jwe;\n}\nexports.default = {\n  fromSplit: fromSplit,\n  decode: decode,\n  encode: encode\n};","map":{"version":3,"names":["utils_1","require","fromSplit","split","_split","_slicedToArray","protectedHeader","encrypted_key","iv","ciphertext","tag","jwe","protected","recipients","encodeRecipient","recipient","encRec","fromBase64url","header","encode","encJwe","aad","map","unprotected","decodeRecipient","encoded","toBase64url","decode","exports","default"],"sources":["/home/gustavo/blockchain/Marketplace/node_modules/dag-jose/src/encryption.ts"],"sourcesContent":["import { fromBase64url, toBase64url } from './utils'\n\ninterface JWERecipient {\n  encrypted_key?: string\n  header?: Record<string, any>\n}\n\nexport interface DagJWE {\n  aad?: string\n  ciphertext: string\n  iv: string\n  protected: string\n  recipients?: Array<JWERecipient>\n  tag: string\n  unprotected?: Record<string, any>\n}\n\ninterface EncodedRecipient {\n  encrypted_key?: Uint8Array\n  header?: Record<string, any>\n}\n\nexport interface EncodedJWE {\n  aad?: Uint8Array\n  ciphertext: Uint8Array\n  iv: Uint8Array\n  protected: Uint8Array\n  recipients?: Array<EncodedRecipient>\n  tag: Uint8Array\n  unprotected?: Record<string, any>\n}\n\nfunction fromSplit(split: Array<string>): DagJWE {\n  const [protectedHeader, encrypted_key, iv, ciphertext, tag] = split\n  const jwe: DagJWE = {\n    ciphertext,\n    iv,\n    protected: protectedHeader,\n    tag,\n  }\n  if (encrypted_key) jwe.recipients = [{ encrypted_key }]\n  return jwe\n}\n\nfunction encodeRecipient(recipient: JWERecipient): EncodedRecipient {\n  const encRec: EncodedRecipient = {}\n  if (recipient.encrypted_key) encRec.encrypted_key = fromBase64url(recipient.encrypted_key)\n  if (recipient.header) encRec.header = recipient.header\n  return encRec\n}\n\nfunction encode(jwe: DagJWE): EncodedJWE {\n  const encJwe: EncodedJWE = {\n    ciphertext: fromBase64url(jwe.ciphertext),\n    protected: fromBase64url(jwe.protected),\n    iv: fromBase64url(jwe.iv),\n    tag: fromBase64url(jwe.tag),\n  }\n  if (jwe.aad) encJwe.aad = fromBase64url(jwe.aad)\n  if (jwe.recipients) encJwe.recipients = jwe.recipients.map(encodeRecipient)\n  if (jwe.unprotected) encJwe.unprotected = jwe.unprotected\n  return encJwe\n}\n\nfunction decodeRecipient(encoded: EncodedRecipient): JWERecipient {\n  const recipient: JWERecipient = {}\n  if (encoded.encrypted_key) recipient.encrypted_key = toBase64url(encoded.encrypted_key)\n  if (encoded.header) recipient.header = encoded.header\n  return recipient\n}\n\nfunction decode(encoded: EncodedJWE): DagJWE {\n  const jwe: DagJWE = {\n    ciphertext: toBase64url(encoded.ciphertext),\n    protected: toBase64url(encoded.protected),\n    iv: toBase64url(encoded.iv),\n    tag: toBase64url(encoded.tag),\n  }\n  if (encoded.aad) jwe.aad = toBase64url(encoded.aad)\n  if (encoded.recipients) jwe.recipients = encoded.recipients.map(decodeRecipient)\n  if (encoded.unprotected) jwe.unprotected = encoded.unprotected\n  return jwe\n}\n\nexport default {\n  fromSplit,\n  decode,\n  encode,\n}\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AAgCA,SAASC,SAASA,CAACC,KAAoB;EACrC,IAAAC,MAAA,GAAAC,cAAA,CAA8DF,KAAK;IAA5DG,eAAe,GAAAF,MAAA;IAAEG,aAAa,GAAAH,MAAA;IAAEI,EAAE,GAAAJ,MAAA;IAAEK,UAAU,GAAAL,MAAA;IAAEM,GAAG,GAAAN,MAAA;EAC1D,IAAMO,GAAG,GAAW;IAClBF,UAAU,EAAVA,UAAU;IACVD,EAAE,EAAFA,EAAE;IACFI,SAAS,EAAEN,eAAe;IAC1BI,GAAG,EAAHA;GACD;EACD,IAAIH,aAAa,EAAEI,GAAG,CAACE,UAAU,GAAG,CAAC;IAAEN,aAAa,EAAbA;EAAa,CAAE,CAAC;EACvD,OAAOI,GAAG;AACZ;AAEA,SAASG,eAAeA,CAACC,SAAuB;EAC9C,IAAMC,MAAM,GAAqB,EAAE;EACnC,IAAID,SAAS,CAACR,aAAa,EAAES,MAAM,CAACT,aAAa,GAAGP,OAAA,CAAAiB,aAAa,CAACF,SAAS,CAACR,aAAa,CAAC;EAC1F,IAAIQ,SAAS,CAACG,MAAM,EAAEF,MAAM,CAACE,MAAM,GAAGH,SAAS,CAACG,MAAM;EACtD,OAAOF,MAAM;AACf;AAEA,SAASG,MAAMA,CAACR,GAAW;EACzB,IAAMS,MAAM,GAAe;IACzBX,UAAU,EAAET,OAAA,CAAAiB,aAAa,CAACN,GAAG,CAACF,UAAU,CAAC;IACzCG,SAAS,EAAEZ,OAAA,CAAAiB,aAAa,CAACN,GAAG,CAACC,SAAS,CAAC;IACvCJ,EAAE,EAAER,OAAA,CAAAiB,aAAa,CAACN,GAAG,CAACH,EAAE,CAAC;IACzBE,GAAG,EAAEV,OAAA,CAAAiB,aAAa,CAACN,GAAG,CAACD,GAAG;GAC3B;EACD,IAAIC,GAAG,CAACU,GAAG,EAAED,MAAM,CAACC,GAAG,GAAGrB,OAAA,CAAAiB,aAAa,CAACN,GAAG,CAACU,GAAG,CAAC;EAChD,IAAIV,GAAG,CAACE,UAAU,EAAEO,MAAM,CAACP,UAAU,GAAGF,GAAG,CAACE,UAAU,CAACS,GAAG,CAACR,eAAe,CAAC;EAC3E,IAAIH,GAAG,CAACY,WAAW,EAAEH,MAAM,CAACG,WAAW,GAAGZ,GAAG,CAACY,WAAW;EACzD,OAAOH,MAAM;AACf;AAEA,SAASI,eAAeA,CAACC,OAAyB;EAChD,IAAMV,SAAS,GAAiB,EAAE;EAClC,IAAIU,OAAO,CAAClB,aAAa,EAAEQ,SAAS,CAACR,aAAa,GAAGP,OAAA,CAAA0B,WAAW,CAACD,OAAO,CAAClB,aAAa,CAAC;EACvF,IAAIkB,OAAO,CAACP,MAAM,EAAEH,SAAS,CAACG,MAAM,GAAGO,OAAO,CAACP,MAAM;EACrD,OAAOH,SAAS;AAClB;AAEA,SAASY,MAAMA,CAACF,OAAmB;EACjC,IAAMd,GAAG,GAAW;IAClBF,UAAU,EAAET,OAAA,CAAA0B,WAAW,CAACD,OAAO,CAAChB,UAAU,CAAC;IAC3CG,SAAS,EAAEZ,OAAA,CAAA0B,WAAW,CAACD,OAAO,CAACb,SAAS,CAAC;IACzCJ,EAAE,EAAER,OAAA,CAAA0B,WAAW,CAACD,OAAO,CAACjB,EAAE,CAAC;IAC3BE,GAAG,EAAEV,OAAA,CAAA0B,WAAW,CAACD,OAAO,CAACf,GAAG;GAC7B;EACD,IAAIe,OAAO,CAACJ,GAAG,EAAEV,GAAG,CAACU,GAAG,GAAGrB,OAAA,CAAA0B,WAAW,CAACD,OAAO,CAACJ,GAAG,CAAC;EACnD,IAAII,OAAO,CAACZ,UAAU,EAAEF,GAAG,CAACE,UAAU,GAAGY,OAAO,CAACZ,UAAU,CAACS,GAAG,CAACE,eAAe,CAAC;EAChF,IAAIC,OAAO,CAACF,WAAW,EAAEZ,GAAG,CAACY,WAAW,GAAGE,OAAO,CAACF,WAAW;EAC9D,OAAOZ,GAAG;AACZ;AAEAiB,OAAA,CAAAC,OAAA,GAAe;EACb3B,SAAS,EAATA,SAAS;EACTyB,MAAM,EAANA,MAAM;EACNR,MAAM,EAANA;CACD"},"metadata":{},"sourceType":"script","externalDependencies":[]}