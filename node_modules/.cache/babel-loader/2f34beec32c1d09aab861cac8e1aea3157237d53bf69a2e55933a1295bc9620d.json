{"ast":null,"code":"import { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport { SendingQuery, PeerResponse, FinalPeer, QueryError, Provider, Value, AddingPeer, DialingPeer } from './response-types.js';\nimport { Multiaddr } from 'multiaddr';\nexport const mapEvent = event => {\n  if (event.Type === SendingQuery) {\n    return {\n      to: event.ID,\n      name: 'SENDING_QUERY',\n      type: event.Type\n    };\n  }\n  if (event.Type === PeerResponse) {\n    return {\n      from: event.ID,\n      name: 'PEER_RESPONSE',\n      type: event.Type,\n      messageType: 0,\n      messageName: 'PUT_VALUE',\n      closer: (event.Responses || []).map(_ref => {\n        let {\n          ID,\n          Addrs\n        } = _ref;\n        return {\n          id: ID,\n          multiaddrs: Addrs.map(addr => new Multiaddr(addr))\n        };\n      }),\n      providers: (event.Responses || []).map(_ref2 => {\n        let {\n          ID,\n          Addrs\n        } = _ref2;\n        return {\n          id: ID,\n          multiaddrs: Addrs.map(addr => new Multiaddr(addr))\n        };\n      })\n    };\n  }\n  if (event.Type === FinalPeer) {\n    let peer = {\n      id: event.ID,\n      multiaddrs: []\n    };\n    if (event.Responses && event.Responses.length) {\n      peer = {\n        id: event.Responses[0].ID,\n        multiaddrs: event.Responses[0].Addrs.map(addr => new Multiaddr(addr))\n      };\n    }\n    return {\n      from: event.ID,\n      name: 'FINAL_PEER',\n      type: event.Type,\n      peer\n    };\n  }\n  if (event.Type === QueryError) {\n    return {\n      from: event.ID,\n      name: 'QUERY_ERROR',\n      type: event.Type,\n      error: new Error(event.Extra)\n    };\n  }\n  if (event.Type === Provider) {\n    return {\n      from: event.ID,\n      name: 'PROVIDER',\n      type: event.Type,\n      providers: event.Responses.map(_ref3 => {\n        let {\n          ID,\n          Addrs\n        } = _ref3;\n        return {\n          id: ID,\n          multiaddrs: Addrs.map(addr => new Multiaddr(addr))\n        };\n      })\n    };\n  }\n  if (event.Type === Value) {\n    return {\n      from: event.ID,\n      name: 'VALUE',\n      type: event.Type,\n      value: uint8ArrayFromString(event.Extra, 'base64pad')\n    };\n  }\n  if (event.Type === AddingPeer) {\n    const peers = event.Responses.map(_ref4 => {\n      let {\n        ID\n      } = _ref4;\n      return ID;\n    });\n    if (!peers.length) {\n      throw new Error('No peer found');\n    }\n    return {\n      name: 'ADDING_PEER',\n      type: event.Type,\n      peer: peers[0]\n    };\n  }\n  if (event.Type === DialingPeer) {\n    return {\n      name: 'DIALING_PEER',\n      type: event.Type,\n      peer: event.ID\n    };\n  }\n  throw new Error('Unknown DHT event type');\n};","map":{"version":3,"names":["fromString","uint8ArrayFromString","SendingQuery","PeerResponse","FinalPeer","QueryError","Provider","Value","AddingPeer","DialingPeer","Multiaddr","mapEvent","event","Type","to","ID","name","type","from","messageType","messageName","closer","Responses","map","_ref","Addrs","id","multiaddrs","addr","providers","_ref2","peer","length","error","Error","Extra","_ref3","value","peers","_ref4"],"sources":["/home/gustavo/blockchain/Marketplace/node_modules/ipfs-http-client/esm/src/dht/map-event.js"],"sourcesContent":["import { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';\nimport {\n  SendingQuery,\n  PeerResponse,\n  FinalPeer,\n  QueryError,\n  Provider,\n  Value,\n  AddingPeer,\n  DialingPeer\n} from './response-types.js';\nimport { Multiaddr } from 'multiaddr';\nexport const mapEvent = event => {\n  if (event.Type === SendingQuery) {\n    return {\n      to: event.ID,\n      name: 'SENDING_QUERY',\n      type: event.Type\n    };\n  }\n  if (event.Type === PeerResponse) {\n    return {\n      from: event.ID,\n      name: 'PEER_RESPONSE',\n      type: event.Type,\n      messageType: 0,\n      messageName: 'PUT_VALUE',\n      closer: (event.Responses || []).map(({ID, Addrs}) => ({\n        id: ID,\n        multiaddrs: Addrs.map(addr => new Multiaddr(addr))\n      })),\n      providers: (event.Responses || []).map(({ID, Addrs}) => ({\n        id: ID,\n        multiaddrs: Addrs.map(addr => new Multiaddr(addr))\n      }))\n    };\n  }\n  if (event.Type === FinalPeer) {\n    let peer = {\n      id: event.ID,\n      multiaddrs: []\n    };\n    if (event.Responses && event.Responses.length) {\n      peer = {\n        id: event.Responses[0].ID,\n        multiaddrs: event.Responses[0].Addrs.map(addr => new Multiaddr(addr))\n      };\n    }\n    return {\n      from: event.ID,\n      name: 'FINAL_PEER',\n      type: event.Type,\n      peer\n    };\n  }\n  if (event.Type === QueryError) {\n    return {\n      from: event.ID,\n      name: 'QUERY_ERROR',\n      type: event.Type,\n      error: new Error(event.Extra)\n    };\n  }\n  if (event.Type === Provider) {\n    return {\n      from: event.ID,\n      name: 'PROVIDER',\n      type: event.Type,\n      providers: event.Responses.map(({ID, Addrs}) => ({\n        id: ID,\n        multiaddrs: Addrs.map(addr => new Multiaddr(addr))\n      }))\n    };\n  }\n  if (event.Type === Value) {\n    return {\n      from: event.ID,\n      name: 'VALUE',\n      type: event.Type,\n      value: uint8ArrayFromString(event.Extra, 'base64pad')\n    };\n  }\n  if (event.Type === AddingPeer) {\n    const peers = event.Responses.map(({ID}) => ID);\n    if (!peers.length) {\n      throw new Error('No peer found');\n    }\n    return {\n      name: 'ADDING_PEER',\n      type: event.Type,\n      peer: peers[0]\n    };\n  }\n  if (event.Type === DialingPeer) {\n    return {\n      name: 'DIALING_PEER',\n      type: event.Type,\n      peer: event.ID\n    };\n  }\n  throw new Error('Unknown DHT event type');\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}