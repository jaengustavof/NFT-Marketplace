{"ast":null,"code":"import _classCallCheck from \"/home/gustavo/blockchain/Marketplace/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/gustavo/blockchain/Marketplace/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nexport var SubscriptionTracker = /*#__PURE__*/function () {\n  function SubscriptionTracker() {\n    _classCallCheck(this, SubscriptionTracker);\n    this._subs = new Map();\n  }\n  _createClass(SubscriptionTracker, [{\n    key: \"subscribe\",\n    value: function subscribe(topic, handler, signal) {\n      var _this = this;\n      var topicSubs = this._subs.get(topic) || [];\n      if (topicSubs.find(function (s) {\n        return s.handler === handler;\n      })) {\n        throw new Error(\"Already subscribed to \".concat(topic, \" with this handler\"));\n      }\n      var controller = new AbortController();\n      this._subs.set(topic, [{\n        handler: handler,\n        controller: controller\n      }].concat(topicSubs));\n      if (signal) {\n        signal.addEventListener('abort', function () {\n          return _this.unsubscribe(topic, handler);\n        });\n      }\n      return controller.signal;\n    }\n  }, {\n    key: \"unsubscribe\",\n    value: function unsubscribe(topic, handler) {\n      var subs = this._subs.get(topic) || [];\n      var unsubs;\n      if (handler) {\n        this._subs.set(topic, subs.filter(function (s) {\n          return s.handler !== handler;\n        }));\n        unsubs = subs.filter(function (s) {\n          return s.handler === handler;\n        });\n      } else {\n        this._subs.set(topic, []);\n        unsubs = subs;\n      }\n      if (!(this._subs.get(topic) || []).length) {\n        this._subs.delete(topic);\n      }\n      unsubs.forEach(function (s) {\n        return s.controller.abort();\n      });\n    }\n  }]);\n  return SubscriptionTracker;\n}();","map":{"version":3,"names":["SubscriptionTracker","_classCallCheck","_subs","Map","_createClass","key","value","subscribe","topic","handler","signal","_this","topicSubs","get","find","s","Error","concat","controller","AbortController","set","addEventListener","unsubscribe","subs","unsubs","filter","length","delete","forEach","abort"],"sources":["/home/gustavo/blockchain/Marketplace/node_modules/ipfs-http-client/esm/src/pubsub/subscription-tracker.js"],"sourcesContent":["export class SubscriptionTracker {\n  constructor() {\n    this._subs = new Map();\n  }\n  subscribe(topic, handler, signal) {\n    const topicSubs = this._subs.get(topic) || [];\n    if (topicSubs.find(s => s.handler === handler)) {\n      throw new Error(`Already subscribed to ${ topic } with this handler`);\n    }\n    const controller = new AbortController();\n    this._subs.set(topic, [{\n        handler,\n        controller\n      }].concat(topicSubs));\n    if (signal) {\n      signal.addEventListener('abort', () => this.unsubscribe(topic, handler));\n    }\n    return controller.signal;\n  }\n  unsubscribe(topic, handler) {\n    const subs = this._subs.get(topic) || [];\n    let unsubs;\n    if (handler) {\n      this._subs.set(topic, subs.filter(s => s.handler !== handler));\n      unsubs = subs.filter(s => s.handler === handler);\n    } else {\n      this._subs.set(topic, []);\n      unsubs = subs;\n    }\n    if (!(this._subs.get(topic) || []).length) {\n      this._subs.delete(topic);\n    }\n    unsubs.forEach(s => s.controller.abort());\n  }\n}"],"mappings":";;AAAA,WAAaA,mBAAmB;EAC9B,SAAAA,oBAAA,EAAc;IAAAC,eAAA,OAAAD,mBAAA;IACZ,IAAI,CAACE,KAAK,GAAG,IAAIC,GAAG,CAAC,CAAC;EACxB;EAACC,YAAA,CAAAJ,mBAAA;IAAAK,GAAA;IAAAC,KAAA,EACD,SAAAC,UAAUC,KAAK,EAAEC,OAAO,EAAEC,MAAM,EAAE;MAAA,IAAAC,KAAA;MAChC,IAAMC,SAAS,GAAG,IAAI,CAACV,KAAK,CAACW,GAAG,CAACL,KAAK,CAAC,IAAI,EAAE;MAC7C,IAAII,SAAS,CAACE,IAAI,CAAC,UAAAC,CAAC;QAAA,OAAIA,CAAC,CAACN,OAAO,KAAKA,OAAO;MAAA,EAAC,EAAE;QAC9C,MAAM,IAAIO,KAAK,0BAAAC,MAAA,CAA2BT,KAAK,uBAAqB,CAAC;MACvE;MACA,IAAMU,UAAU,GAAG,IAAIC,eAAe,CAAC,CAAC;MACxC,IAAI,CAACjB,KAAK,CAACkB,GAAG,CAACZ,KAAK,EAAE,CAAC;QACnBC,OAAO,EAAPA,OAAO;QACPS,UAAU,EAAVA;MACF,CAAC,CAAC,CAACD,MAAM,CAACL,SAAS,CAAC,CAAC;MACvB,IAAIF,MAAM,EAAE;QACVA,MAAM,CAACW,gBAAgB,CAAC,OAAO,EAAE;UAAA,OAAMV,KAAI,CAACW,WAAW,CAACd,KAAK,EAAEC,OAAO,CAAC;QAAA,EAAC;MAC1E;MACA,OAAOS,UAAU,CAACR,MAAM;IAC1B;EAAC;IAAAL,GAAA;IAAAC,KAAA,EACD,SAAAgB,YAAYd,KAAK,EAAEC,OAAO,EAAE;MAC1B,IAAMc,IAAI,GAAG,IAAI,CAACrB,KAAK,CAACW,GAAG,CAACL,KAAK,CAAC,IAAI,EAAE;MACxC,IAAIgB,MAAM;MACV,IAAIf,OAAO,EAAE;QACX,IAAI,CAACP,KAAK,CAACkB,GAAG,CAACZ,KAAK,EAAEe,IAAI,CAACE,MAAM,CAAC,UAAAV,CAAC;UAAA,OAAIA,CAAC,CAACN,OAAO,KAAKA,OAAO;QAAA,EAAC,CAAC;QAC9De,MAAM,GAAGD,IAAI,CAACE,MAAM,CAAC,UAAAV,CAAC;UAAA,OAAIA,CAAC,CAACN,OAAO,KAAKA,OAAO;QAAA,EAAC;MAClD,CAAC,MAAM;QACL,IAAI,CAACP,KAAK,CAACkB,GAAG,CAACZ,KAAK,EAAE,EAAE,CAAC;QACzBgB,MAAM,GAAGD,IAAI;MACf;MACA,IAAI,CAAC,CAAC,IAAI,CAACrB,KAAK,CAACW,GAAG,CAACL,KAAK,CAAC,IAAI,EAAE,EAAEkB,MAAM,EAAE;QACzC,IAAI,CAACxB,KAAK,CAACyB,MAAM,CAACnB,KAAK,CAAC;MAC1B;MACAgB,MAAM,CAACI,OAAO,CAAC,UAAAb,CAAC;QAAA,OAAIA,CAAC,CAACG,UAAU,CAACW,KAAK,CAAC,CAAC;MAAA,EAAC;IAC3C;EAAC;EAAA,OAAA7B,mBAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}