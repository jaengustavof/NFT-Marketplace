{"ast":null,"code":"import _regeneratorRuntime from \"/home/gustavo/blockchain/Marketplace/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _objectSpread from \"/home/gustavo/blockchain/Marketplace/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"/home/gustavo/blockchain/Marketplace/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _wrapAsyncGenerator from \"/home/gustavo/blockchain/Marketplace/node_modules/@babel/runtime/helpers/esm/wrapAsyncGenerator.js\";\nimport _awaitAsyncGenerator from \"/home/gustavo/blockchain/Marketplace/node_modules/@babel/runtime/helpers/esm/awaitAsyncGenerator.js\";\nimport _asyncGeneratorDelegate from \"/home/gustavo/blockchain/Marketplace/node_modules/@babel/runtime/helpers/esm/asyncGeneratorDelegate.js\";\nimport _asyncIterator from \"/home/gustavo/blockchain/Marketplace/node_modules/@babel/runtime/helpers/esm/asyncIterator.js\";\nimport { CID } from 'multiformats/cid';\nimport { configure } from './lib/configure.js';\nimport { toUrlSearchParams } from './lib/to-url-search-params.js';\nimport { createStat } from './files/stat.js';\nexport var createLs = configure(function (api, opts) {\n  function ls(_x) {\n    return _ls.apply(this, arguments);\n  }\n  function _ls() {\n    _ls = _wrapAsyncGenerator(function (path) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var pathStr, mapLink, _mapLink, res, _iteratorAbruptCompletion, _didIteratorError, _iteratorError, _iterator, _step, result, links;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _mapLink = function _mapLink3() {\n                _mapLink = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(link) {\n                  var hash, ipfsPath, stats, entry;\n                  return _regeneratorRuntime().wrap(function _callee$(_context) {\n                    while (1) switch (_context.prev = _context.next) {\n                      case 0:\n                        hash = link.Hash;\n                        if (!hash.includes('/')) {\n                          _context.next = 9;\n                          break;\n                        }\n                        ipfsPath = hash.startsWith('/ipfs/') ? hash : \"/ipfs/\".concat(hash);\n                        _context.next = 5;\n                        return createStat(opts)(ipfsPath);\n                      case 5:\n                        stats = _context.sent;\n                        hash = stats.cid;\n                        _context.next = 10;\n                        break;\n                      case 9:\n                        hash = CID.parse(hash);\n                      case 10:\n                        entry = {\n                          name: link.Name,\n                          path: pathStr + (link.Name ? \"/\".concat(link.Name) : ''),\n                          size: link.Size,\n                          cid: hash,\n                          type: typeOf(link)\n                        };\n                        if (link.Mode) {\n                          entry.mode = parseInt(link.Mode, 8);\n                        }\n                        if (link.Mtime !== undefined && link.Mtime !== null) {\n                          entry.mtime = {\n                            secs: link.Mtime\n                          };\n                          if (link.MtimeNsecs !== undefined && link.MtimeNsecs !== null) {\n                            entry.mtime.nsecs = link.MtimeNsecs;\n                          }\n                        }\n                        return _context.abrupt(\"return\", entry);\n                      case 14:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }, _callee);\n                }));\n                return _mapLink.apply(this, arguments);\n              };\n              mapLink = function _mapLink2(_x2) {\n                return _mapLink.apply(this, arguments);\n              };\n              pathStr = \"\".concat(path instanceof Uint8Array ? CID.decode(path) : path);\n              _context2.next = 5;\n              return _awaitAsyncGenerator(api.post('ls', {\n                signal: options.signal,\n                searchParams: toUrlSearchParams(_objectSpread({\n                  arg: pathStr\n                }, options)),\n                headers: options.headers\n              }));\n            case 5:\n              res = _context2.sent;\n              _iteratorAbruptCompletion = false;\n              _didIteratorError = false;\n              _context2.prev = 8;\n              _iterator = _asyncIterator(res.ndjson());\n            case 10:\n              _context2.next = 12;\n              return _awaitAsyncGenerator(_iterator.next());\n            case 12:\n              if (!(_iteratorAbruptCompletion = !(_step = _context2.sent).done)) {\n                _context2.next = 31;\n                break;\n              }\n              result = _step.value;\n              result = result.Objects;\n              if (result) {\n                _context2.next = 17;\n                break;\n              }\n              throw new Error('expected .Objects in results');\n            case 17:\n              result = result[0];\n              if (result) {\n                _context2.next = 20;\n                break;\n              }\n              throw new Error('expected one array in results.Objects');\n            case 20:\n              links = result.Links;\n              if (Array.isArray(links)) {\n                _context2.next = 23;\n                break;\n              }\n              throw new Error('expected one array in results.Objects[0].Links');\n            case 23:\n              if (links.length) {\n                _context2.next = 27;\n                break;\n              }\n              _context2.next = 26;\n              return mapLink(result);\n            case 26:\n              return _context2.abrupt(\"return\");\n            case 27:\n              return _context2.delegateYield(_asyncGeneratorDelegate(_asyncIterator(links.map(mapLink)), _awaitAsyncGenerator), \"t0\", 28);\n            case 28:\n              _iteratorAbruptCompletion = false;\n              _context2.next = 10;\n              break;\n            case 31:\n              _context2.next = 37;\n              break;\n            case 33:\n              _context2.prev = 33;\n              _context2.t1 = _context2[\"catch\"](8);\n              _didIteratorError = true;\n              _iteratorError = _context2.t1;\n            case 37:\n              _context2.prev = 37;\n              _context2.prev = 38;\n              if (!(_iteratorAbruptCompletion && _iterator.return != null)) {\n                _context2.next = 42;\n                break;\n              }\n              _context2.next = 42;\n              return _awaitAsyncGenerator(_iterator.return());\n            case 42:\n              _context2.prev = 42;\n              if (!_didIteratorError) {\n                _context2.next = 45;\n                break;\n              }\n              throw _iteratorError;\n            case 45:\n              return _context2.finish(42);\n            case 46:\n              return _context2.finish(37);\n            case 47:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[8, 33, 37, 47], [38,, 42, 46]]);\n      })();\n    });\n    return _ls.apply(this, arguments);\n  }\n  return ls;\n});\nfunction typeOf(link) {\n  switch (link.Type) {\n    case 1:\n    case 5:\n      return 'dir';\n    case 2:\n      return 'file';\n    default:\n      return 'file';\n  }\n}","map":{"version":3,"names":["CID","configure","toUrlSearchParams","createStat","createLs","api","opts","ls","_x","_ls","apply","arguments","_wrapAsyncGenerator","path","options","length","undefined","_regeneratorRuntime","mark","_callee2","pathStr","mapLink","_mapLink","res","_iteratorAbruptCompletion","_didIteratorError","_iteratorError","_iterator","_step","result","links","wrap","_callee2$","_context2","prev","next","_mapLink3","_asyncToGenerator","_callee","link","hash","ipfsPath","stats","entry","_callee$","_context","Hash","includes","startsWith","concat","sent","cid","parse","name","Name","size","Size","type","typeOf","Mode","mode","parseInt","Mtime","mtime","secs","MtimeNsecs","nsecs","abrupt","stop","_mapLink2","_x2","Uint8Array","decode","_awaitAsyncGenerator","post","signal","searchParams","_objectSpread","arg","headers","_asyncIterator","ndjson","done","value","Objects","Error","Links","Array","isArray","delegateYield","_asyncGeneratorDelegate","map","t1","return","finish","Type"],"sources":["/home/gustavo/blockchain/Marketplace/node_modules/ipfs-http-client/esm/src/ls.js"],"sourcesContent":["import { CID } from 'multiformats/cid';\nimport { configure } from './lib/configure.js';\nimport { toUrlSearchParams } from './lib/to-url-search-params.js';\nimport { createStat } from './files/stat.js';\nexport const createLs = configure((api, opts) => {\n  async function* ls(path, options = {}) {\n    const pathStr = `${ path instanceof Uint8Array ? CID.decode(path) : path }`;\n    async function mapLink(link) {\n      let hash = link.Hash;\n      if (hash.includes('/')) {\n        const ipfsPath = hash.startsWith('/ipfs/') ? hash : `/ipfs/${ hash }`;\n        const stats = await createStat(opts)(ipfsPath);\n        hash = stats.cid;\n      } else {\n        hash = CID.parse(hash);\n      }\n      const entry = {\n        name: link.Name,\n        path: pathStr + (link.Name ? `/${ link.Name }` : ''),\n        size: link.Size,\n        cid: hash,\n        type: typeOf(link)\n      };\n      if (link.Mode) {\n        entry.mode = parseInt(link.Mode, 8);\n      }\n      if (link.Mtime !== undefined && link.Mtime !== null) {\n        entry.mtime = { secs: link.Mtime };\n        if (link.MtimeNsecs !== undefined && link.MtimeNsecs !== null) {\n          entry.mtime.nsecs = link.MtimeNsecs;\n        }\n      }\n      return entry;\n    }\n    const res = await api.post('ls', {\n      signal: options.signal,\n      searchParams: toUrlSearchParams({\n        arg: pathStr,\n        ...options\n      }),\n      headers: options.headers\n    });\n    for await (let result of res.ndjson()) {\n      result = result.Objects;\n      if (!result) {\n        throw new Error('expected .Objects in results');\n      }\n      result = result[0];\n      if (!result) {\n        throw new Error('expected one array in results.Objects');\n      }\n      const links = result.Links;\n      if (!Array.isArray(links)) {\n        throw new Error('expected one array in results.Objects[0].Links');\n      }\n      if (!links.length) {\n        yield mapLink(result);\n        return;\n      }\n      yield* links.map(mapLink);\n    }\n  }\n  return ls;\n});\nfunction typeOf(link) {\n  switch (link.Type) {\n  case 1:\n  case 5:\n    return 'dir';\n  case 2:\n    return 'file';\n  default:\n    return 'file';\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}